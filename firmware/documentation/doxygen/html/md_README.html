<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>InterconnectIO_Master: First TestStation InterconnectIO firmware Master 700-2000-011</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">InterconnectIO_Master<span id="projectnumber">&#160;700-2000-010</span>
   </div>
   <div id="projectbrief">Master Firmware to be loaded on the Pico Master device on InterconnectIO Board</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">First TestStation InterconnectIO firmware Master 700-2000-011 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The complete FTS project is documented on a github website: <a href="https://dlock8.github.io/FTS_Website/">https://dlock8.github.io/FTS_Website/</a></p>
<p >On this deposit, we have the firmware used to create the Master Pico load to control the interconnectIO board.</p>
<p >The hardware support for the firmware is on github location: <a href="https://github.com/dlock8/InterconnectIO_Board">https://github.com/dlock8/InterconnectIO_Board</a></p>
<p >The Master Pico software is the earth of interconnectIO board. The software receive SCPI command from the serial port, execute the action requested by the command and return answer to the user.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
License</h1>
<p >This project is licensed under the BSD 3-Clause License. See the <a href="./LICENSE">LICENSE</a> file for more details.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Project setup</h1>
<p >This project was initially developed in 2020 on a Raspberry Pi 4, following the installation instructions from Getting Started with Pico_C.pdf Version 1.4.</p>
<p >The current version has been developed on a Raspberry Pi 5 using Visual Studio with the Raspberry Pi Pico extension, following the instructions in Getting Started with Pico_C.pdf dated 15 October 2024.</p>
<p >For debugging, we utilize the GPIO pins of the Raspberry Pi 5, instead of the suggested debug probe.</p>
<p >Initially based on <a href="https://github.com/cronologic-de/webusb">https://github.com/cronologic-de/webusb</a>, the project has evolved to be a complete SCPI instrument without frontend interface (next phase).</p>
<p >The compilation is performed using Visual Studio and the extension installed are:</p>
<ul>
<li>Raspberry Pi Pico Visual Studio Code extension 0.17.2</li>
<li>Doxygen Documentation Generator v1.4.0</li>
<li>Doxygen runner v1.8.0</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Building</h1>
<p >Build of this cmake project is performed with Visual Studio</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Development</h1>
<ul>
<li><a href="master.c"><code>master.c</code></a> is the main source file for the firmware.</li>
<li><a href="CMakeLists.txt"><code>CMakeLists.txt</code></a> contains build instructions for CMake, including how to build the SCPI library.</li>
<li><a href="pico_sdk_import.cmake"><code>pico_sdk_import.cmake</code></a> was (as usual) copied verbatim from the Pico SDK and allows CMake to interact with the SDKâ€™s functionality.</li>
<li><a href="raspberrypi-swd.cfg"><code>raspberrypi-swd.cfg</code></a> need to be copied on openocd interface folder (../.pico-sdk/openocd/0.12.0+dev/scripts/interface/) if GPIO pins is used to debug project.</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Installation</h1>
<ul>
<li>The Files INTERCONNECTIO_MASTER.uf2 contains the firmware to be loaded on the Pico RP2040 board using USB cable and boot button.</li>
<li>When software loaded, the Pico board should be installed on the location marked MASTER on interconnectIO Board.</li>
<li>On board Pico Led will flash slowly (heartbeat) on power ON.</li>
<li>Loading INTERCONNECTIO_MASTER.uf2 will trigger the watchdog, resulting in a burst of beeps during the boot sequence to signal the watchdog timeout. Only cycling the power ON/OFF will reset the watchdog trigger flag.</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
Beep code</h1>
<p >The boot sequence performs basic diagnostics. A failure in the tests will result in a burst of beeps. The error codes are as follows:</p>
<ul>
<li>1 Beep Burst: Master Pico's temperature is too high</li>
<li>2 Beep Burst: Master Pico's system voltage (VSYS) is out of limits</li>
<li>3 Beep Burst: Error in the internal I2C communication</li>
<li>4 Beep Burst: Error reading parameters from I2C EEPROM; default values will be used</li>
<li>5 Beep Burst: A watchdog timeout has occurred on the Master Pico.</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
SCPI command supported by the InterconnectIO Board</h1>
<p >The main communication for the InterconnectIO Board is based on the SCPI standard, developed by Jan Breuer [<a href="https://www.jaybee.cz/scpi-parser/">https://www.jaybee.cz/scpi-parser/</a>]. According to the SCPI standard, some commands are mandatory, while others can be developed by the designer. In this section, we provide a list of the required SCPI commands as well as those developed specifically to control the InterconnectIO Board.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Required SCPI commands</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">SCPI_COMMAND   </th><th class="markdownTableHeadLeft">COMMENT    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">*IDN?   </td><td class="markdownTableBodyLeft">Identification string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">*RST   </td><td class="markdownTableBodyLeft">Reset Command    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">*CLS   </td><td class="markdownTableBodyLeft">Clear Status    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">*ESE   </td><td class="markdownTableBodyLeft">Standard Event Status Enable Register    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">*ESR   </td><td class="markdownTableBodyLeft">Standard Event Status Register    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">*OPC   </td><td class="markdownTableBodyLeft">Operation Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">*SRE   </td><td class="markdownTableBodyLeft">Service Request Enable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">*STB   </td><td class="markdownTableBodyLeft">Read Status Byte    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">*TST   </td><td class="markdownTableBodyLeft">Internal SelfTest    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">*WAI   </td><td class="markdownTableBodyLeft">Wait-to-Continue (Do nothing on this parser)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SYSTem:ERRor[:NEXT]?   </td><td class="markdownTableBodyLeft">Read actual error on the error FIFO    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SYSTem:ERRor:COUNt?   </td><td class="markdownTableBodyLeft">read number of errors in the FIFO    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SYSTem:VERSion?   </td><td class="markdownTableBodyLeft">read SCPI version used    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">STATus:QUEStionable[:EVENt]?   </td><td class="markdownTableBodyLeft">queries the event register (QUES) for the Questionable Data register    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">STATus:QUEStionable:CONDition?   </td><td class="markdownTableBodyLeft">queries the condition register (QUESC) for the Questionable Data register    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">STATus:QUEStionable:ENABle   </td><td class="markdownTableBodyLeft">set the status enable register (QUESE) for the Questionable Data register    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">STATus:QUEStionable:ENABle?   </td><td class="markdownTableBodyLeft">queries the status enable register (QUESE) for the Questionable Data register    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">STATus:OPERation[:EVENt]?   </td><td class="markdownTableBodyLeft">queries the event register (OPER) for the operation Data register    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">STATus:OPERation:CONDition?   </td><td class="markdownTableBodyLeft">queries the condition register (OPERC) for the operation Data register    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">STATus:OPERation:ENABle   </td><td class="markdownTableBodyLeft">set the status enable register (OPERE) for the operation Data register    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">STATus:OPERation:ENABle?   </td><td class="markdownTableBodyLeft">queries the status enable register (OPERE) for the operation Data register   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md9"></a>
SCPI command associated to the InterconnectIO Board</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">SCPI_COMMAND   </th><th class="markdownTableHeadLeft">PARAMETER   </th><th class="markdownTableHeadLeft">COMMENT    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:CLOSe   </td><td class="markdownTableBodyLeft">(&lt;ch_list&gt;)   </td><td class="markdownTableBodyLeft">Close relay based on number    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:CLOSe:EXCLusive   </td><td class="markdownTableBodyLeft">(&lt;ch_list&gt;)   </td><td class="markdownTableBodyLeft">open relay already closed on the bank and close relay listed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:CLOSe:Rev   </td><td class="markdownTableBodyLeft">{BANK1-BANK4}   </td><td class="markdownTableBodyLeft">Close reverse relay to move the contact from HIGH side to LOW side of differential relay    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:OPEN   </td><td class="markdownTableBodyLeft">(&lt;ch_list&gt;)   </td><td class="markdownTableBodyLeft">Open relay from the channel list    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:OPEN:Rev   </td><td class="markdownTableBodyLeft">{BANK1-BANK4}   </td><td class="markdownTableBodyLeft">Open reverse relay to move the contact to HIGH side of differential relay    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:OPEN:ALL   </td><td class="markdownTableBodyLeft">{BANK1-BANK4|ALL}   </td><td class="markdownTableBodyLeft">Open all relays from a particular Bank or all relays from all banks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:CHANnel:STATe?   </td><td class="markdownTableBodyLeft">(&lt;ch_list&gt;)   </td><td class="markdownTableBodyLeft">Return state of the relay in the channel list, 0: open relay, 1: Close relay    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:BANK:STATe?   </td><td class="markdownTableBodyLeft">{BANK1-BANK4}   </td><td class="markdownTableBodyLeft">Read decimal value of relays state on the particular bank. Each bank is a byte long    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:REV:STATe?   </td><td class="markdownTableBodyLeft">{BANK1-BANK4}   </td><td class="markdownTableBodyLeft">Read contact side of reverse relay, LOW Side = 0, HIGH side = 1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:CLOSe:PWR   </td><td class="markdownTableBodyLeft">{LPR1|HPR1|HPR2|SSR1}   </td><td class="markdownTableBodyLeft">Close the designated power relay    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:OPEN:PWR   </td><td class="markdownTableBodyLeft">{LPR1|HPR1|HPR2|SSR1}   </td><td class="markdownTableBodyLeft">Open the designated power relay    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:STATe:PWR?   </td><td class="markdownTableBodyLeft">{LPR1|HPR1|HPR2|SSR1}   </td><td class="markdownTableBodyLeft">Read state of the power relay, 0: Open, 1:Closed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTE:CLOSe:OC   </td><td class="markdownTableBodyLeft">{OC1|OC2|OC3}   </td><td class="markdownTableBodyLeft">Close or activate the designated open collector transistor    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTE:OPEN:OC   </td><td class="markdownTableBodyLeft">{OC1|OC2|OC3}   </td><td class="markdownTableBodyLeft">Open or deactivate the designated open collector transistor    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTE:STATe:OC?   </td><td class="markdownTableBodyLeft">{OC1|OC2|OC3}   </td><td class="markdownTableBodyLeft">Read state of the the designated open collector transistor, 0: Open, 1:Closed    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">DIGital:In:PORTn?   </td><td class="markdownTableBodyLeft">{0-1}   </td><td class="markdownTableBodyLeft">Read Decimal value of the designated digital port (port0: 8 bits, port1: 8 bits)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DIGital:In:PORTn:BITn?   </td><td class="markdownTableBodyLeft">{0-1}   </td><td class="markdownTableBodyLeft">Read value of the bit position at the designated port    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">DIGital:Out:PORTn   </td><td class="markdownTableBodyLeft">{0-1}{&lt;value&gt;}   </td><td class="markdownTableBodyLeft">At the designated digital port, set the output to the value (byte)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DIGital:Out:PORTn:BItn   </td><td class="markdownTableBodyLeft">{0-1} {0-7} {&lt;value&gt;}   </td><td class="markdownTableBodyLeft">At the designated digital port and the designated bit, set the output to the value    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">DIGital:DIRection:PORTn   </td><td class="markdownTableBodyLeft">{0-1}{|value|}   </td><td class="markdownTableBodyLeft">Set the direction of the designated port to the value (byte), 0: input, 1: output    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DIGital:DIRection:PORTn:BITn   </td><td class="markdownTableBodyLeft">{0-1} {0-7} {&lt;value&gt;}   </td><td class="markdownTableBodyLeft">At the designated digital port and the designated bit, set the direction to the value    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">DIGital:DIRection:PORTn?   </td><td class="markdownTableBodyLeft">{0-1}   </td><td class="markdownTableBodyLeft">Read the direction value for the designated port    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DIGital:DIRection:PORTn:BITn?   </td><td class="markdownTableBodyLeft">{0-1} {0-7}   </td><td class="markdownTableBodyLeft">Read the direction value for the designated port and the designated bit position    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GPIO:DIRection:DEVice#:GP#   </td><td class="markdownTableBodyLeft">{0-3} {0-28} {0-1}   </td><td class="markdownTableBodyLeft">At the designated device and defined gpio number, set the direction to input (0) or output (1). <br  />
DEVice0: Master_Pico (SCPI interpreter) <br  />
 DEVice1: Slave1_Pico (Digital Port 0 &amp; 1) <br  />
 DEVice2: Slave2_Pico (relay bank 1 &amp; 3) <br  />
 DEVice3: Slave3_Pico (relay bank 2 &amp; 4)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">GPIO:Out:DEVice#:GP#   </td><td class="markdownTableBodyLeft">{0-3} {0-28} {0-1}   </td><td class="markdownTableBodyLeft">At the designated device and defined gpio number, set the output to the value.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GPIO:In:DEVice#:GP#?   </td><td class="markdownTableBodyLeft">{0-3} {0-28}   </td><td class="markdownTableBodyLeft">At the designated device and defined gpio number, read the value of the GPIO.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">GPIO:SETPad:DEVice#:GP#   </td><td class="markdownTableBodyLeft">{0-3} {0-28} {&lt;Value&gt;}   </td><td class="markdownTableBodyLeft">At the designated device and defined gpio number, set the pad value.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GPIO:GETPad:DEVice#:GP#?   </td><td class="markdownTableBodyLeft">{0-3} {0-28}   </td><td class="markdownTableBodyLeft">At the designated device and defined gpio number,read the pad value. <br  />
 <b>PAD REGISTER DEFINITION</b> <br  />
 Bit 7: &ensp; OD Output disable <br  />
 Bit 6: &ensp; IE Input enable <br  />
 Bit 5:4 &ensp;DRIVE Strength 0x0: 2mA, 0x1: 4mA, 0x2: 8mA, 0x3: 12mA<br  />
 Bit 3:&ensp; PUE Pull up enable <br  />
Bit 2:&ensp; PDE Pull down enable<br  />
Bit 1:&ensp; SCHT Enable schmidt trigger<br  />
Bit 0:&ensp; SLF Slew rate control 1=fast 0 = slow <br  />
    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ANAlog:DAC:Volt   </td><td class="markdownTableBodyLeft">&lt;value&gt;   </td><td class="markdownTableBodyLeft">Set DAC output to the value    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ANAlog:DAC:Save   </td><td class="markdownTableBodyLeft">&lt;Value&gt;   </td><td class="markdownTableBodyLeft">Save a default value for startup    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:ADC0:Volt?   </td><td class="markdownTableBodyLeft">Read Voltage at ADC input 0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:ADC1:Volt?   </td><td class="markdownTableBodyLeft">Read Voltage at ADC input 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:ADC:Vsys?   </td><td class="markdownTableBodyLeft">Read system voltage from Pico Master    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:ADC:Temp?   </td><td class="markdownTableBodyLeft">Read Pico Master internal temperature in Celsius    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:PWR:Volt?   </td><td class="markdownTableBodyLeft">Read voltage at load using power monitoring device    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:PWR:Shunt?   </td><td class="markdownTableBodyLeft">Read voltage at the shunt resistor (0.1 ohm) using power monitoring device    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:PWR:Ima?   </td><td class="markdownTableBodyLeft">Read current(mA) passing in the shunt resistor (calculation I = E/R)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">ANAlog:PWR:Pmw?   </td><td class="markdownTableBodyLeft">Read power(mW) at the load (calculation P = VI)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ANAlog:PWR:Cal   </td><td class="markdownTableBodyLeft">&lt;actualValue,expectedValue&gt;   </td><td class="markdownTableBodyLeft">calibrate current(mA) on full range to get more precision    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">SYSTem:DEVice:VERSion?   </td><td class="markdownTableBodyLeft">Return firmware version of Pico for Master, Slave1, Slave2 and Slave3    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">SYSTem:BEEPer   </td><td class="markdownTableBodyLeft">Generate beep pulse    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SYSTem:LED:ERRor   </td><td class="markdownTableBodyLeft">{0|1|OFF|ON}   </td><td class="markdownTableBodyLeft">Manual control of the read error led    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">SYSTem:LED:ERRor?   </td><td class="markdownTableBodyLeft">Status of the error led    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SYSTem:OUTput   </td><td class="markdownTableBodyLeft">{0|1|OFF|ON}   </td><td class="markdownTableBodyLeft">Turn ON/OFF internal 5V available to UUT.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">SYSTem:OUTput?   </td><td class="markdownTableBodyLeft">Read output status 0: OFF, 1: ON    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SYSTem:SLAves   </td><td class="markdownTableBodyLeft">{0|1|OFF|ON}   </td><td class="markdownTableBodyLeft">Turn ON/OFF Pico slaves controller (run signals)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">SYSTem:SLAves?   </td><td class="markdownTableBodyLeft">0: All Pico Slaves disabled, 1: All Pico Slaves enabled    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">SYSTem:SLAves:STAtus?   </td><td class="markdownTableBodyLeft">read Pico device 'status byte' for slaves 1 to 3    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SYSTem:TESTboard   </td><td class="markdownTableBodyLeft">{0-5}   </td><td class="markdownTableBodyLeft">Selftest execute from menu below <br  />
 <b>0</b> Input test number to execute (0 to exit) <br  />
 <b>1</b> Selftest using only selftest board, no check of onewire <br  />
 <b>2</b> Selftest run only if selftest board is installed, onewire validation <br  />
 <b>3</b> Selftest using selftest board and loopback connector <br  />
 <b>4</b> Selftest of instruments in manual mode using selftest board <br  />
 <b>5</b> Test of SCPI command,selftest board is required    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">CFG:Write:Eeprom:STR   </td><td class="markdownTableBodyLeft">'varname string,value string'   </td><td class="markdownTableBodyLeft">valid varname = <br  />
 **'partnumber'**: partnumber of the InterconnectIO board, default: '500-1000-010' <br  />
 **'serialnumber'** : serial number of the InterconnectIO board, default: '00001' <br  />
 **'mod_option'** : optional module installed on the InterconnectIO board, default: 'DAC,PWR'<br  />
 **'com_ser_speed'** : baudrate used by the SCPI command serial port, default: '115200'<br  />
 **'pico_slaves_run'** : flag to control the slaves RUN pin actuation. 0: Pico Slaves reset at each boot(disable USB), 1: Do not reset slaves at boot, default: '0'<br  />
 **'testboard_num'** : partnumber of the selftest board written on the onewire device , default: '500-1010-020'    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">CFG:Write:Eeprom:Default   </td><td class="markdownTableBodyLeft">Special command to write all default value to eeprom    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">CFG:Read:Eeprom:Full?   </td><td class="markdownTableBodyLeft">Special command to read all data on eeprom    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">CFG:Read:Eeprom:STR?   </td><td class="markdownTableBodyLeft">'varnames string'   </td><td class="markdownTableBodyLeft">Reads string value from the designated parameter   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md10"></a>
SCPI command associated to the communication</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">SCPI_COMMAND   </th><th class="markdownTableHeadLeft">PARAMETER   </th><th class="markdownTableHeadLeft">COMMENT    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:1WIRE:CHECK?   </td><td class="markdownTableBodyLeft">&lt;value&gt;   </td><td class="markdownTableBodyLeft">value = Number of expected Onewire devices on a link, normally 1 or 2, Check if devices are detected    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:1WIRE:WRITE   </td><td class="markdownTableBodyLeft">{String 64 chars maximum starting with 64bits lasered ROM}   </td><td class="markdownTableBodyLeft">example: 2D4CE282200000CC, 500-1010-020, 000001, J1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:1WIRE:READ?   </td><td class="markdownTableBodyLeft">[Nb of Onewire devices]   </td><td class="markdownTableBodyLeft">read string of all the 1-Wire devices on the link, specify number of onewire to be read    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:INITialize:ENAble   </td><td class="markdownTableBodyLeft">{SPI|SERIAL|I2C}   </td><td class="markdownTableBodyLeft">Configure designated communication port    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:INITialize:DISable   </td><td class="markdownTableBodyLeft">{SPI|SERIAL|I2C}   </td><td class="markdownTableBodyLeft">Configure designated communication port to GPIO    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:INITialize:STATus?   </td><td class="markdownTableBodyLeft">{SPI|SERIAL|I2C}   </td><td class="markdownTableBodyLeft">Read if the designated communication is enable or disable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SERIAL:WRITE   </td><td class="markdownTableBodyLeft">&lt;svalues&gt;   </td><td class="markdownTableBodyLeft">send string, don't wait for answer    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:SERIAL:READ?   </td><td class="markdownTableBodyLeft">&lt;svalues&gt;   </td><td class="markdownTableBodyLeft">send string, wait for answer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SERIAL:Baud   </td><td class="markdownTableBodyLeft">&lt;value&gt;   </td><td class="markdownTableBodyLeft">set baudrate speed    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SERIAL:Baud?   </td><td class="markdownTableBodyLeft">read baudrate speed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SERIAL:Protocol   </td><td class="markdownTableBodyLeft">&lt;svalues&gt;   </td><td class="markdownTableBodyLeft">exa: {N81 O72 E61 8N1 etc ..}. Three character to define protocol to be use    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SERIAL:Protocol?   </td><td class="markdownTableBodyLeft">read the used protocol    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SERIAL:Handshake   </td><td class="markdownTableBodyLeft">{0|1|OFF|ON}   </td><td class="markdownTableBodyLeft">set the RTS-CTS handshake according to the value    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SERIAL:Handshake?   </td><td class="markdownTableBodyLeft">read value corresponding to the handshake state, 0: disabled, 1: enabled    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SERIAL:Timeout   </td><td class="markdownTableBodyLeft">&lt;values&gt;   </td><td class="markdownTableBodyLeft">Timeout in ms (32bits), default is 1000    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SERIAL:Timeout?   </td><td class="markdownTableBodyLeft">read value of the timeout    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SPI:WRIte   </td><td class="markdownTableBodyLeft">&lt;data&gt;   </td><td class="markdownTableBodyLeft">Spi write data (byte if databit =8 or word if databits = 16)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:SPI:REAd:LENx?   </td><td class="markdownTableBodyLeft">&lt;opt:register&gt;   </td><td class="markdownTableBodyLeft">Spi read x bytes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SPI:Baudrate   </td><td class="markdownTableBodyLeft">&lt;value&gt;   </td><td class="markdownTableBodyLeft">Set baudrate speed in Hz    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SPI:Baudrate?   </td><td class="markdownTableBodyLeft">read SPI speed in Hz    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SPI:CS   </td><td class="markdownTableBodyLeft">&lt;gpio&gt;   </td><td class="markdownTableBodyLeft">Set Chipselect gpio,default is 5, valid num = {0,1,5,6,7,12,13,14,15,16,17}    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SPI:CS?   </td><td class="markdownTableBodyLeft">Get Chipselect gpio number    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SPI:Databits   </td><td class="markdownTableBodyLeft">&lt;value&gt;   </td><td class="markdownTableBodyLeft">// number of data bits to read or write during SPI communication, normally 8 (byte long) or 16 (word long)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SPI:Databits?   </td><td class="markdownTableBodyLeft">read databit value    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:SPI:Mode   </td><td class="markdownTableBodyLeft">{0|1|2|3|4|5|6|7}   </td><td class="markdownTableBodyLeft">Set SPI mode + ChipSelect toggle mode (0:End of transmit, 1: At each byte) <br  />
mode 0: Cs=0, Cpol=0, CPha=0 <br  />
 mode 1: Cs=0, Cpol=0, Cpha=1 <br  />
 mode 2: Cs=0, Cpol=1, Cpha=0 <br  />
 mode 3: Cs=0, Cpol=1, Cpha=1 <br  />
 mode 4: Cs=1, Cpol=0, CPha=0 <br  />
 mode 5: Cs=1, Cpol=0, Cpha=1 <br  />
 mode 6: Cs=1, Cpol=1, Cpha=0 <br  />
 mode 7: Cs=1, Cpol=1, Cpha=1 <br  />
    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:SPI:Mode?   </td><td class="markdownTableBodyLeft">read mode number used    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:I2C:WRIte   </td><td class="markdownTableBodyLeft">&lt;data&gt;   </td><td class="markdownTableBodyLeft">Spi write data    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:I2C:REAd:LENx?   </td><td class="markdownTableBodyLeft">&lt;opt:register&gt;   </td><td class="markdownTableBodyLeft">Spi read x bytes from optional register    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:I2C:ADDRress   </td><td class="markdownTableBodyLeft">&lt;Device address&gt;   </td><td class="markdownTableBodyLeft">I2C Address to use to talk to the device    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:I2C:ADDRress?   </td><td class="markdownTableBodyLeft">read address value    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft" colspan="2">COM:I2C:Baudrate?   </td><td class="markdownTableBodyLeft">read I2C speed in Hz    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:I2C:Baudrate   </td><td class="markdownTableBodyLeft">&lt;value&gt;   </td><td class="markdownTableBodyLeft">Set speed in Hz    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">COM:I2C:Databits   </td><td class="markdownTableBodyLeft">&lt;value&gt;   </td><td class="markdownTableBodyLeft">Number of databits to write or read. Normally 8 (bytes) or 16 (word)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft" colspan="2">COM:I2C:Databits?   </td><td class="markdownTableBodyLeft">read number of databits used on I2C communication   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md11"></a>
SCPI Complete Command example:</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">SCPI_COMMAND   </th><th class="markdownTableHeadLeft">COMMENT    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:CLOSe(@101)   </td><td class="markdownTableBodyLeft">Close relay 101, Signal on High side    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:CLOSe:EXC(@102)   </td><td class="markdownTableBodyLeft">open relay on bank1 (101) and close relay 102    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:CLOSe (@108,115)   </td><td class="markdownTableBodyLeft">close relay 108 and 115, signal on low side    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:CLOSe (@100:104)   </td><td class="markdownTableBodyLeft">close relay 100,101,102,103, and 104    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:OPEN:ALL BANK1,BANK2   </td><td class="markdownTableBodyLeft">open relay on bank1 and bank2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:OPEN:ALL ALL   </td><td class="markdownTableBodyLeft">open relay on all banks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ROUTe:REV:STATe? BANK1   </td><td class="markdownTableBodyLeft">read which side of diff relay we are connected (0 = H or 1 = L)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ROUTe:CHAN:STATe? (@100)   </td><td class="markdownTableBodyLeft">read relay state ( 0 = Open or 1 = close)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DIGital:DIRection:PORT0 #HFF   </td><td class="markdownTableBodyLeft">set the 8 bit of port0 to output ( 0 = in, 1 = out)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">DIGital:Out:PORT1 #H55   </td><td class="markdownTableBodyLeft">Write hex value 0x55 to port 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DIGital:DIRection:PORT1?   </td><td class="markdownTableBodyLeft">Read direction on port 1 for the 8 bits ( 0 = in, 1 = out)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">DIGital:In:PORT0?   </td><td class="markdownTableBodyLeft">Read the 8 bits on port 0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">GPIO:DIRection:DEVice0:GP22 1   </td><td class="markdownTableBodyLeft">Set gpio 22 on Device 0 (Master) to direction out (1 = out)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GPIO:Out:DEVice1:GP8 0   </td><td class="markdownTableBodyLeft">Set gpio 8 on Device 1 (Slave_1) to 0 (0 = low level)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">GPIO:In:DEVice2:GP9?   </td><td class="markdownTableBodyLeft">Read value of gpio 9 on device 2 (Slave_2)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GPIO:SETPad:DEVice3:GP22   </td><td class="markdownTableBodyLeft">Set PAD value (8 bits) on gpio 22 on Device 3 (Slave_3)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">GPIO:GETPad:DEVice1:GP8?   </td><td class="markdownTableBodyLeft">Read PAD value (8 bits) on gpio 8 on Device 1 (Slave_1)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SYSTem:BEEPer   </td><td class="markdownTableBodyLeft">Turn ON momentary the beeper    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SYSTEM:DEVice:VERsion?   </td><td class="markdownTableBodyLeft">Read version of each Pico devices [0,1,2,3], return string <br  />
 ex: 1.0, 1.0, 1.0 1.0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">COM:1WIRE:WRITE "2D4CE282200000CC, 500-1010-020, 000001, J1"   </td><td class="markdownTableBodyLeft">Lasered ROM + Board#+ Serial + Location   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md12"></a>
Relay numbering scheme</h1>
<pre class="fragment">Relay bank 1   Differential: 10 @ 17    Single: 100 @ 107 (High) 108 @ 115 (Low)    
Relay bank 2   Differential: 20 @ 27    Single: 200 @ 215 (High) 208 @ 215 (Low) 
Relay bank 3   Differential: 30 @ 37    Single: 300 @ 315 (High) 308 @ 315 (Low) 
Relay bank 4   Differential: 40 @ 47    Single: 400 @ 415 (High) 108 @ 415 (Low) 
</pre><ul>
<li>Relay type are DPDT (Double Pole Double Throw). Relay could be connected in differential mode or configured in single ended mode</li>
<li>Relay address used reflect the difference between the differential and single mode.</li>
<li>Relay @10, @100 and @108 are the same physical relay. <br  />
</li>
<li>If relay @10 is closed, the high side of the relay (BK1_CH0_H) will be connected on high side of the common point (BK1_COM_H). The low side of the relay (BK1_CH0_L) will be connected on the low side of the common point (BK1_COM_L)</li>
<li>If relay @100 is closed, the high side of the relay (BK1_CH0_H) will be connected on high side of the common point (BK1_COM_H). The low side of the relay (BK1_CH0_L) will be connected on the low side of the common point (BK1_COM_L)</li>
<li>If relay @108 is closed, the high side of the relay (BK1_CH0_H) will be connected on low side of the common point (BK1_COM_L) because the reverse relay will be actuated on the same time of the relay @108. The low side of the relay (BK1_CH0_L) will be connected on the high side of the common point (BK1_COM_H)</li>
<li>The 4 relay banks are identical and follow the same rules </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
