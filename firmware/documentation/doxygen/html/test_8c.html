<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>InterconnectIO Master: firmware/src/test.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">InterconnectIO Master
   &#160;<span id="projectnumber">700-2000-010</span>
   </div>
   <div id="projectbrief">Master Firmware to be loaded on the Pico Master device on InterconnectIO Board</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('test_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">test.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Software code used to validate the software and hardware developed on this project.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;pico/stdlib.h&quot;</code><br />
<code>#include &quot;pico/binary_info.h&quot;</code><br />
<code>#include &quot;<a class="el" href="dev__ina219_8h_source.html">pico_lib2/src/dev/dev_ina219/dev_ina219.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dev__mcp4725_8h_source.html">pico_lib2/src/dev/dev_mcp4725/dev_mcp4725.h</a>&quot;</code><br />
<code>#include &quot;pico_lib2/src/dev/dev_24lc32/dev_24lc32.h&quot;</code><br />
<code>#include &quot;<a class="el" href="dev__ds2431_8h_source.html">pico_lib2/src/dev/dev_ds2431/dev_ds2431.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sys__adc_8h_source.html">pico_lib2/src/sys/include/sys_adc.h</a>&quot;</code><br />
<code>#include &quot;hardware/watchdog.h&quot;</code><br />
<code>#include &quot;hardware/uart.h&quot;</code><br />
<code>#include &quot;hardware/spi.h&quot;</code><br />
<code>#include &quot;hardware/i2c.h&quot;</code><br />
<code>#include &quot;<a class="el" href="functadv_8h_source.html">include/functadv.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fts__scpi_8h_source.html">include/fts_scpi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="i2c__com_8h_source.html">include/i2c_com.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="master_8h_source.html">include/master.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="test_8h_source.html">include/test.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scpi__spi_8h_source.html">include/scpi_spi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scpi__i2c_8h_source.html">include/scpi_i2c.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test.c:</div>
<div class="dyncontent">
<div class="center"><img src="test_8c__incl.png" border="0" usemap="#afirmware_2src_2test_8c" alt=""/></div>
<map name="afirmware_2src_2test_8c" id="afirmware_2src_2test_8c">
<area shape="rect" title="Software code used to validate the software and hardware developed on this project." alt="" coords="1146,5,1289,32"/>
<area shape="rect" title=" " alt="" coords="5,87,72,114"/>
<area shape="rect" title=" " alt="" coords="97,87,167,114"/>
<area shape="rect" title=" " alt="" coords="192,87,293,114"/>
<area shape="rect" title=" " alt="" coords="317,87,456,114"/>
<area shape="rect" href="dev__ina219_8h.html" title=" " alt="" coords="939,80,1103,121"/>
<area shape="rect" title=" " alt="" coords="1022,259,1141,285"/>
<area shape="rect" href="dev__mcp4725_8h.html" title="MCP4725 One Channel 12&#45;bit ADC." alt="" coords="531,80,727,121"/>
<area shape="rect" href="dev__24lc32_8h_source.html" title=" " alt="" coords="752,80,915,121"/>
<area shape="rect" href="dev__ds2431_8h.html" title="Header to perform communication with OneWire device." alt="" coords="1280,80,1451,121"/>
<area shape="rect" href="sys__adc_8h.html" title="Analog to Digital Converter Functions." alt="" coords="351,169,531,211"/>
<area shape="rect" title=" " alt="" coords="1475,87,1637,114"/>
<area shape="rect" title=" " alt="" coords="1661,87,1787,114"/>
<area shape="rect" title=" " alt="" coords="1811,87,1930,114"/>
<area shape="rect" href="functadv_8h.html" title="Header file defining constants and macros for the complex function." alt="" coords="929,177,1071,203"/>
<area shape="rect" href="fts__scpi_8h.html" title="Header file defining constants and macros used for SCPI interpreter." alt="" coords="1954,87,2089,114"/>
<area shape="rect" href="i2c__com_8h.html" title="Header file defining constants and macros for internal i2c bus." alt="" coords="1095,177,1233,203"/>
<area shape="rect" href="master_8h.html" title="Header file defining constants and macros used on the main file." alt="" coords="2113,87,2244,114"/>
<area shape="rect" href="test_8h.html" title="Header file defining constants and macros for buffer and message management." alt="" coords="2269,87,2379,114"/>
<area shape="rect" href="scpi__spi_8h.html" title="Header file defining constants and macros for the SPI communication." alt="" coords="2403,87,2541,114"/>
<area shape="rect" href="scpi__i2c_8h.html" title="Header file defining constants and macros for the I2C communication." alt="" coords="2565,87,2702,114"/>
<area shape="rect" href="sys__i2c_8h.html" title="I2C Functions Module." alt="" coords="709,169,854,211"/>
<area shape="rect" title=" " alt="" coords="559,259,630,285"/>
<area shape="rect" title=" " alt="" coords="740,259,823,285"/>
<area shape="rect" title=" " alt="" coords="1976,177,2067,203"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCircularBuffer.html">CircularBuffer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure who contains circular buffer messages and pointer.  <a href="structCircularBuffer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTestResult.html">TestResult</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to count the test result during selftest sequence.  <a href="structTestResult.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a688698feef67230ede6647246e24b000"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a688698feef67230ede6647246e24b000">TEST_SCPI_INPUT</a>(cmd)&#160;&#160;&#160;result = SCPI_Input(&amp;<a class="el" href="fts__scpi_8h.html#ac6f639c26fd1c7e210c2da424cfe628d">scpi_context</a>, cmd, strlen(cmd))</td></tr>
<tr class="memdesc:a688698feef67230ede6647246e24b000"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to simulate SCPI command input via the master serial port.  <a href="test_8c.html#a688698feef67230ede6647246e24b000">More...</a><br /></td></tr>
<tr class="separator:a688698feef67230ede6647246e24b000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519adc2af3ba06a8f0548b6690050a89"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a519adc2af3ba06a8f0548b6690050a89">PAGESIZE</a>&#160;&#160;&#160;32</td></tr>
<tr class="memdesc:a519adc2af3ba06a8f0548b6690050a89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of a single page in the EEPROM.  <a href="test_8c.html#a519adc2af3ba06a8f0548b6690050a89">More...</a><br /></td></tr>
<tr class="separator:a519adc2af3ba06a8f0548b6690050a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ee3c5eb7aa12299c6e815edd421d59"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#ae9ee3c5eb7aa12299c6e815edd421d59">EEMODEL</a>&#160;&#160;&#160;32</td></tr>
<tr class="memdesc:ae9ee3c5eb7aa12299c6e815edd421d59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Model number for the 24LC32 EEPROM.  <a href="test_8c.html#ae9ee3c5eb7aa12299c6e815edd421d59">More...</a><br /></td></tr>
<tr class="separator:ae9ee3c5eb7aa12299c6e815edd421d59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0d8a13def46c49728aeecf05029691e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#aa0d8a13def46c49728aeecf05029691e">RWTESTSIZE</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:aa0d8a13def46c49728aeecf05029691e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes to read/write during the EEPROM validation test.  <a href="test_8c.html#aa0d8a13def46c49728aeecf05029691e">More...</a><br /></td></tr>
<tr class="separator:aa0d8a13def46c49728aeecf05029691e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9313b8b09e2402dbd3215a879dfa18d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a9313b8b09e2402dbd3215a879dfa18d2">removeCRLF</a> (char *str)</td></tr>
<tr class="memdesc:a9313b8b09e2402dbd3215a879dfa18d2"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>ChatGPt function to remove CR and LF from a string </li>
</ul>
 <a href="test_8c.html#a9313b8b09e2402dbd3215a879dfa18d2">More...</a><br /></td></tr>
<tr class="separator:a9313b8b09e2402dbd3215a879dfa18d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a964f12386d49fd5a0df6add2daf20508"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a964f12386d49fd5a0df6add2daf20508">init_buffer</a> (<a class="el" href="structCircularBuffer.html">CircularBuffer</a> *buffer)</td></tr>
<tr class="memdesc:a964f12386d49fd5a0df6add2daf20508"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation of the index for circular buffer.  <a href="test_8c.html#a964f12386d49fd5a0df6add2daf20508">More...</a><br /></td></tr>
<tr class="separator:a964f12386d49fd5a0df6add2daf20508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac470ff61e56e684cfbe729e66aedf0c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#ac470ff61e56e684cfbe729e66aedf0c1">add_message</a> (<a class="el" href="structCircularBuffer.html">CircularBuffer</a> *buffer, const char *message)</td></tr>
<tr class="memdesc:ac470ff61e56e684cfbe729e66aedf0c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to add_message on circular buffer.  <a href="test_8c.html#ac470ff61e56e684cfbe729e66aedf0c1">More...</a><br /></td></tr>
<tr class="separator:ac470ff61e56e684cfbe729e66aedf0c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade29dc0be6bd27144ab8ac944fad90de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#ade29dc0be6bd27144ab8ac944fad90de">print_messages</a> (const <a class="el" href="structCircularBuffer.html">CircularBuffer</a> *buffer)</td></tr>
<tr class="memdesc:ade29dc0be6bd27144ab8ac944fad90de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to print message saved on circular buffer.  <a href="test_8c.html#ade29dc0be6bd27144ab8ac944fad90de">More...</a><br /></td></tr>
<tr class="separator:ade29dc0be6bd27144ab8ac944fad90de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a741d0c84f19f8a596e9db8a3055383"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a3a741d0c84f19f8a596e9db8a3055383">test_cmd_result</a> (const char *title, const char *cmd, float expect_value, const char *unit, float lo_limit, float hi_limit, struct <a class="el" href="structTestResult.html">TestResult</a> *counter, <a class="el" href="structCircularBuffer.html">CircularBuffer</a> *buffer)</td></tr>
<tr class="memdesc:a3a741d0c84f19f8a596e9db8a3055383"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Send SCPI command and validate the value for PASS or FAIL. The analog value returned by command is validated to determine is between determined limit </li>
</ul>
 <a href="test_8c.html#a3a741d0c84f19f8a596e9db8a3055383">More...</a><br /></td></tr>
<tr class="separator:a3a741d0c84f19f8a596e9db8a3055383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9513558e25e8efc4248c5f6c4dcd18e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#af9513558e25e8efc4248c5f6c4dcd18e">test_cmd_out</a> (const char *title, const char *cmd, char *expected_result, struct <a class="el" href="structTestResult.html">TestResult</a> *counter, <a class="el" href="structCircularBuffer.html">CircularBuffer</a> *buffer)</td></tr>
<tr class="memdesc:af9513558e25e8efc4248c5f6c4dcd18e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Send SCPI command and validate the value for PASS or FAIL. The answer value returned by command is validated with the expected result </li>
</ul>
 <a href="test_8c.html#af9513558e25e8efc4248c5f6c4dcd18e">More...</a><br /></td></tr>
<tr class="separator:af9513558e25e8efc4248c5f6c4dcd18e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a032a8eab3b1447960ec13ee39358c450"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a032a8eab3b1447960ec13ee39358c450">test_cmd_substring</a> (const char *title, const char *cmd, char *expected_substring, struct <a class="el" href="structTestResult.html">TestResult</a> *counter, <a class="el" href="structCircularBuffer.html">CircularBuffer</a> *buffer)</td></tr>
<tr class="memdesc:a032a8eab3b1447960ec13ee39358c450"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if the given command string contains the expected substring.  <a href="test_8c.html#a032a8eab3b1447960ec13ee39358c450">More...</a><br /></td></tr>
<tr class="separator:a032a8eab3b1447960ec13ee39358c450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c6f39b967bd2a9a74fd40a40cf54687"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a0c6f39b967bd2a9a74fd40a40cf54687">read_uart_char</a> ()</td></tr>
<tr class="memdesc:a0c6f39b967bd2a9a74fd40a40cf54687"><td class="mdescLeft">&#160;</td><td class="mdescRight">function to wait for read character from user. The loop refresh the watchdog timeout  <a href="test_8c.html#a0c6f39b967bd2a9a74fd40a40cf54687">More...</a><br /></td></tr>
<tr class="separator:a0c6f39b967bd2a9a74fd40a40cf54687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d279cdda41da5b1e2775dbfeaae220"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#ac9d279cdda41da5b1e2775dbfeaae220">internal_test_sequence</a> (const char *testboard_num, uint8_t run)</td></tr>
<tr class="memdesc:ac9d279cdda41da5b1e2775dbfeaae220"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main routine to perform internal test using selftest board. The routine has been used to validate hardware and software during development if run=0, the menu will be displayed to operator to select which internal test to run. IF run &gt; 0, the internal test will run directly.  <a href="test_8c.html#ac9d279cdda41da5b1e2775dbfeaae220">More...</a><br /></td></tr>
<tr class="separator:ac9d279cdda41da5b1e2775dbfeaae220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb420da0ba7e8e1e84b61fec9b4de4b9"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#acb420da0ba7e8e1e84b61fec9b4de4b9">test_selftest</a> (const char *testboard_num, uint8_t run)</td></tr>
<tr class="memdesc:acb420da0ba7e8e1e84b61fec9b4de4b9"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Run test sequence to validate hardware with selftest board </li>
</ul>
 <a href="test_8c.html#acb420da0ba7e8e1e84b61fec9b4de4b9">More...</a><br /></td></tr>
<tr class="separator:acb420da0ba7e8e1e84b61fec9b4de4b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c4492986b11310638a7730bf6658532"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a7c4492986b11310638a7730bf6658532">test_inst_manual</a> ()</td></tr>
<tr class="memdesc:a7c4492986b11310638a7730bf6658532"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>The function perform the selftest of the instruments connected to the interconnect_IO board. The instruments are controlled manually using instruction on the master serial port </li>
</ul>
 <a href="test_8c.html#a7c4492986b11310638a7730bf6658532">More...</a><br /></td></tr>
<tr class="separator:a7c4492986b11310638a7730bf6658532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad171446f146deeb8c2c79986e0f843c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#ad171446f146deeb8c2c79986e0f843c7">test_command</a> (void)</td></tr>
<tr class="memdesc:ad171446f146deeb8c2c79986e0f843c7"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>The function has been used to test the scpi command function. Mainly used to validate software functionalities. selftest board could be required to be present. </li>
</ul>
 <a href="test_8c.html#ad171446f146deeb8c2c79986e0f843c7">More...</a><br /></td></tr>
<tr class="separator:ad171446f146deeb8c2c79986e0f843c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0acd1ee00e871f30689aab1a7246feb0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a0acd1ee00e871f30689aab1a7246feb0">test_ioboard</a> ()</td></tr>
<tr class="memdesc:a0acd1ee00e871f30689aab1a7246feb0"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Function not used during normal execution The function is used to validate the hardware after parts has been soldered and pico has firmware programmed </li>
</ul>
 <a href="test_8c.html#a0acd1ee00e871f30689aab1a7246feb0">More...</a><br /></td></tr>
<tr class="separator:a0acd1ee00e871f30689aab1a7246feb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c9d45ad6f08748305ee5abf775a9544"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a3c9d45ad6f08748305ee5abf775a9544">test_eeprom</a> ()</td></tr>
<tr class="memdesc:a3c9d45ad6f08748305ee5abf775a9544"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Function not used during normal execution The function has been used to validate the eeprom read write by byte and by page </li>
</ul>
 <a href="test_8c.html#a3c9d45ad6f08748305ee5abf775a9544">More...</a><br /></td></tr>
<tr class="separator:a3c9d45ad6f08748305ee5abf775a9544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a0e9953fea609fecae7ddc8fbc33a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a47a0e9953fea609fecae7ddc8fbc33a3">onewiretest</a> ()</td></tr>
<tr class="memdesc:a47a0e9953fea609fecae7ddc8fbc33a3"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Function not used during normal execution function used to validate the onewire write and read </li>
</ul>
 <a href="test_8c.html#a47a0e9953fea609fecae7ddc8fbc33a3">More...</a><br /></td></tr>
<tr class="separator:a47a0e9953fea609fecae7ddc8fbc33a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c187f3a1a5e046de0872ebd623e8d56"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a2c187f3a1a5e046de0872ebd623e8d56">test_adc</a> ()</td></tr>
<tr class="memdesc:a2c187f3a1a5e046de0872ebd623e8d56"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Function not used during normal execution The test_adc was used to test to get all the measure in same time from the Pico ADC </li>
</ul>
 <a href="test_8c.html#a2c187f3a1a5e046de0872ebd623e8d56">More...</a><br /></td></tr>
<tr class="separator:a2c187f3a1a5e046de0872ebd623e8d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74346a55978a0cec00fea16b92e3cd35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a74346a55978a0cec00fea16b92e3cd35">test_ina219</a> (void)</td></tr>
<tr class="memdesc:a74346a55978a0cec00fea16b92e3cd35"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Function not used during normal execution The function was used to test to get all the measure in same time from the INA219 </li>
</ul>
 <a href="test_8c.html#a74346a55978a0cec00fea16b92e3cd35">More...</a><br /></td></tr>
<tr class="separator:a74346a55978a0cec00fea16b92e3cd35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afced784f998c7b95f4563f9ff40d5fc8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#afced784f998c7b95f4563f9ff40d5fc8">power_test</a> (uint8_t mode, float expect_value, float percentage_lo, float percentage_hi)</td></tr>
<tr class="memdesc:afced784f998c7b95f4563f9ff40d5fc8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Function not used during normal execution The power_test was used to test the hardware of interconnect IO board connected to selftest board without using of SCPI command </li>
</ul>
 <a href="test_8c.html#afced784f998c7b95f4563f9ff40d5fc8">More...</a><br /></td></tr>
<tr class="separator:afced784f998c7b95f4563f9ff40d5fc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fd0a3e557c0c44cce4de05c0f581406"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a7fd0a3e557c0c44cce4de05c0f581406">test_dac</a> (float value)</td></tr>
<tr class="memdesc:a7fd0a3e557c0c44cce4de05c0f581406"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function used to set a value on the DAC device.  <a href="test_8c.html#a7fd0a3e557c0c44cce4de05c0f581406">More...</a><br /></td></tr>
<tr class="separator:a7fd0a3e557c0c44cce4de05c0f581406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada61a5d73ba9477f5805e729284f4e17"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#ada61a5d73ba9477f5805e729284f4e17">adc_test</a> (uint8_t channel, float expect_value, float percentage_lo, float percentage_hi)</td></tr>
<tr class="memdesc:ada61a5d73ba9477f5805e729284f4e17"><td class="mdescLeft">&#160;</td><td class="mdescRight"><ul>
<li>Function not used during normal execution The adc_test was used to test the hardware of interconnect IO board connected to selftest board without using of SCPI command </li>
</ul>
 <a href="test_8c.html#ada61a5d73ba9477f5805e729284f4e17">More...</a><br /></td></tr>
<tr class="separator:ada61a5d73ba9477f5805e729284f4e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ec3dc653dc7431f107092091e4dafc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#ae9ec3dc653dc7431f107092091e4dafc">test_spi_adx</a> ()</td></tr>
<tr class="memdesc:ae9ec3dc653dc7431f107092091e4dafc"><td class="mdescLeft">&#160;</td><td class="mdescRight">the software code below is not used by application but could be used, as example on how to work with SPI interface. This example was a proof of concept on SPI command available with a true device (ADXL345).  <a href="test_8c.html#ae9ec3dc653dc7431f107092091e4dafc">More...</a><br /></td></tr>
<tr class="separator:ae9ec3dc653dc7431f107092091e4dafc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38960f95c19009813882cb32075767d8"><td class="memItemLeft" align="right" valign="top"><a id="a38960f95c19009813882cb32075767d8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a38960f95c19009813882cb32075767d8">test_i2c_adx</a> ()</td></tr>
<tr class="memdesc:a38960f95c19009813882cb32075767d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">the software code below is not used by application but could be used, as example on how to work with I2C interface. This example was a proof of concept on I2C command available with a true device (ADXL345) connected to interconnect io board <br /></td></tr>
<tr class="separator:a38960f95c19009813882cb32075767d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2820d2a0e21922a80ee5edaa25d95367"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a2820d2a0e21922a80ee5edaa25d95367">test_i2c_ina219</a> ()</td></tr>
<tr class="memdesc:a2820d2a0e21922a80ee5edaa25d95367"><td class="mdescLeft">&#160;</td><td class="mdescRight">the software code below is not used by application but could be used, as example on how to work with I2C interface. This example was a proof of concept on I2C command available with a true device (INA219).  <a href="test_8c.html#a2820d2a0e21922a80ee5edaa25d95367">More...</a><br /></td></tr>
<tr class="separator:a2820d2a0e21922a80ee5edaa25d95367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af935e2bc2c8e175077947a8197df0234"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#af935e2bc2c8e175077947a8197df0234">wait_button_pressed</a> ()</td></tr>
<tr class="memdesc:af935e2bc2c8e175077947a8197df0234"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility function to help debug of firmware Button is connected between pin 1 and 4 of CTRL INST connector on the back of interconnect IO.  <a href="test_8c.html#af935e2bc2c8e175077947a8197df0234">More...</a><br /></td></tr>
<tr class="separator:af935e2bc2c8e175077947a8197df0234"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af4c8396614d93905c2a91f60b9d2b4fd"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#af4c8396614d93905c2a91f60b9d2b4fd">out_buffer</a> [1024]</td></tr>
<tr class="memdesc:af4c8396614d93905c2a91f60b9d2b4fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output buffer for storing data to be sent.  <a href="test_8c.html#af4c8396614d93905c2a91f60b9d2b4fd">More...</a><br /></td></tr>
<tr class="separator:af4c8396614d93905c2a91f60b9d2b4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668cec89f06b89ddf4d1ee33527eba18"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_8c.html#a668cec89f06b89ddf4d1ee33527eba18">out_buffer_pos</a></td></tr>
<tr class="memdesc:a668cec89f06b89ddf4d1ee33527eba18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current position in the output buffer.  <a href="test_8c.html#a668cec89f06b89ddf4d1ee33527eba18">More...</a><br /></td></tr>
<tr class="separator:a668cec89f06b89ddf4d1ee33527eba18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Software code used to validate the software and hardware developed on this project. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Lockhead </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024</dd></dl>
<p>This file contains all software functions used to validate the combination of the selftest board connected to the interconnect IO board. The SCPI command has been validated, and the interconnect IO board hardware has been validated using a step-by-step debugger.</p>
<p>The internal selftest is a complete example of how to test the interconnect IO board using the selftest board. External instruments connected to the interconnect IO board are validated using true instruments or a loopback connector.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2024, D.Lockhead. All rights reserved.</dd></dl>
<p>This software is licensed under the BSD 3-Clause License. See the LICENSE file for more details. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae9ee3c5eb7aa12299c6e815edd421d59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ee3c5eb7aa12299c6e815edd421d59">&#9670;&nbsp;</a></span>EEMODEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EEMODEL&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Model number for the 24LC32 EEPROM. </p>
<p>This macro represents the model number of the EEPROM being used. In this case, it indicates the 24LC32 EEPROM. </p>

</div>
</div>
<a id="a519adc2af3ba06a8f0548b6690050a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a519adc2af3ba06a8f0548b6690050a89">&#9670;&nbsp;</a></span>PAGESIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PAGESIZE&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of a single page in the EEPROM. </p>
<p>This macro defines the number of bytes in a single page of the 24LC32 EEPROM. It is used to control how data is written and read from the EEPROM. </p>

</div>
</div>
<a id="aa0d8a13def46c49728aeecf05029691e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0d8a13def46c49728aeecf05029691e">&#9670;&nbsp;</a></span>RWTESTSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RWTESTSIZE&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes to read/write during the EEPROM validation test. </p>
<p>This macro defines the size of data blocks to be used for read/write operations during EEPROM testing. </p>

</div>
</div>
<a id="a688698feef67230ede6647246e24b000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a688698feef67230ede6647246e24b000">&#9670;&nbsp;</a></span>TEST_SCPI_INPUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEST_SCPI_INPUT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">cmd</td><td>)</td>
          <td>&#160;&#160;&#160;result = SCPI_Input(&amp;<a class="el" href="fts__scpi_8h.html#ac6f639c26fd1c7e210c2da424cfe628d">scpi_context</a>, cmd, strlen(cmd))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macro to simulate SCPI command input via the master serial port. </p>
<p>This macro simulates receiving an SCPI command string and processes it using the SCPI context. It calls the <code>SCPI_Input</code> function to handle the command input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cmd</td><td>The SCPI command string to be processed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This macro assigns the result of <code>SCPI_Input</code> to a variable named <code>result</code>. Ensure that the variable <code>result</code> is defined before using this macro. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ada61a5d73ba9477f5805e729284f4e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada61a5d73ba9477f5805e729284f4e17">&#9670;&nbsp;</a></span>adc_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool adc_test </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>expect_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>percentage_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>percentage_hi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Function not used during normal execution The adc_test was used to test the hardware of interconnect IO board connected to selftest board without using of SCPI command </li>
</ul>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel</td><td>Number to define which measurement channel is required </td></tr>
    <tr><td class="paramname">expect_value</td><td>Value expected to be a valid value </td></tr>
    <tr><td class="paramname">percentage_lo</td><td>Lower deviation from expect_value acceptable to PASS the test </td></tr>
    <tr><td class="paramname">percentage_hi</td><td>Higher deviation from expect_value acceptable to PASS the test </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="ac470ff61e56e684cfbe729e66aedf0c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac470ff61e56e684cfbe729e66aedf0c1">&#9670;&nbsp;</a></span>add_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCircularBuffer.html">CircularBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to add_message on circular buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>pointer to structure who contains messages </td></tr>
    <tr><td class="paramname">message</td><td>pointer to message to save on structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a964f12386d49fd5a0df6add2daf20508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a964f12386d49fd5a0df6add2daf20508">&#9670;&nbsp;</a></span>init_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCircularBuffer.html">CircularBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialisation of the index for circular buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Structure who contains the index and message </td></tr>
  </table>
  </dd>
</dl>
<p>&lt; Initialize Start index of the buffer</p>
<p>&lt; Initialize End index of the buffer</p>
<p>&lt; Initialize Flag indicating if the buffer is full</p>

</div>
</div>
<a id="ac9d279cdda41da5b1e2775dbfeaae220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9d279cdda41da5b1e2775dbfeaae220">&#9670;&nbsp;</a></span>internal_test_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_test_sequence </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>testboard_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>run</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main routine to perform internal test using selftest board. The routine has been used to validate hardware and software during development if run=0, the menu will be displayed to operator to select which internal test to run. IF run &gt; 0, the internal test will run directly. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">testboard_num</td><td>Partnumber of the selftest board to be validated using 1-wire data </td></tr>
    <tr><td class="paramname">run</td><td>Test number to run, if equal to 0, the test menu will be displayed </td></tr>
  </table>
  </dd>
</dl>
<p>Open Power Relay to remove power on Selftest board</p>

</div>
</div>
<a id="a47a0e9953fea609fecae7ddc8fbc33a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a0e9953fea609fecae7ddc8fbc33a3">&#9670;&nbsp;</a></span>onewiretest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int onewiretest </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Function not used during normal execution function used to validate the onewire write and read </li>
</ul>
</p>
<dl class="section return"><dt>Returns</dt><dd>int return 0 when completed </dd></dl>

</div>
</div>
<a id="afced784f998c7b95f4563f9ff40d5fc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afced784f998c7b95f4563f9ff40d5fc8">&#9670;&nbsp;</a></span>power_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool power_test </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>expect_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>percentage_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>percentage_hi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Function not used during normal execution The power_test was used to test the hardware of interconnect IO board connected to selftest board without using of SCPI command </li>
</ul>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>Number to define which measurement need to be performed* </td></tr>
    <tr><td class="paramname">expect_value</td><td>Value expected to be a valid value </td></tr>
    <tr><td class="paramname">percentage_lo</td><td>Lower deviation from expect_value acceptable to PASS the test </td></tr>
    <tr><td class="paramname">percentage_hi</td><td>Higher deviation from expect_value acceptable to PASS the test </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="ade29dc0be6bd27144ab8ac944fad90de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade29dc0be6bd27144ab8ac944fad90de">&#9670;&nbsp;</a></span>print_messages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_messages </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structCircularBuffer.html">CircularBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to print message saved on circular buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>pointer to structure who contains messages </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0c6f39b967bd2a9a74fd40a40cf54687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c6f39b967bd2a9a74fd40a40cf54687">&#9670;&nbsp;</a></span>read_uart_char()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char read_uart_char </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>function to wait for read character from user. The loop refresh the watchdog timeout </p>
<dl class="section return"><dt>Returns</dt><dd>char character entry by the user </dd></dl>

</div>
</div>
<a id="a9313b8b09e2402dbd3215a879dfa18d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9313b8b09e2402dbd3215a879dfa18d2">&#9670;&nbsp;</a></span>removeCRLF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void removeCRLF </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>ChatGPt function to remove CR and LF from a string </li>
</ul>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>String who contains the CR and LF to remove </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String without CR and LF </dd></dl>

</div>
</div>
<a id="a2c187f3a1a5e046de0872ebd623e8d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c187f3a1a5e046de0872ebd623e8d56">&#9670;&nbsp;</a></span>test_adc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool test_adc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Function not used during normal execution The test_adc was used to test to get all the measure in same time from the Pico ADC </li>
</ul>
</p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="af9513558e25e8efc4248c5f6c4dcd18e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9513558e25e8efc4248c5f6c4dcd18e">&#9670;&nbsp;</a></span>test_cmd_out()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_cmd_out </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>expected_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structTestResult.html">TestResult</a> *&#160;</td>
          <td class="paramname"><em>counter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCircularBuffer.html">CircularBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Send SCPI command and validate the value for PASS or FAIL. The answer value returned by command is validated with the expected result </li>
</ul>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">title</td><td>Test title to be used to report the purpose of the measure </td></tr>
    <tr><td class="paramname">cmd</td><td>String command to send to the SCPI engine </td></tr>
    <tr><td class="paramname">expected_result</td><td>String to validate with the result returned by the command </td></tr>
    <tr><td class="paramname">counter</td><td>Structure who content the result of test. Be used by final report </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to circular buffer, who contains the error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<p>Send command to SCPI engine</p>

</div>
</div>
<a id="a3a741d0c84f19f8a596e9db8a3055383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a741d0c84f19f8a596e9db8a3055383">&#9670;&nbsp;</a></span>test_cmd_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_cmd_result </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>expect_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lo_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>hi_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structTestResult.html">TestResult</a> *&#160;</td>
          <td class="paramname"><em>counter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCircularBuffer.html">CircularBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Send SCPI command and validate the value for PASS or FAIL. The analog value returned by command is validated to determine is between determined limit </li>
</ul>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">title</td><td>Test title to be used to report the purpose of the measure </td></tr>
    <tr><td class="paramname">cmd</td><td>String command to send to the SCPI engine </td></tr>
    <tr><td class="paramname">expect_value</td><td>Value expected to be returned by the measure </td></tr>
    <tr><td class="paramname">unit</td><td>unit to use on printf </td></tr>
    <tr><td class="paramname">lo_limit</td><td>Lower deviation from expect_value acceptable to PASS the test </td></tr>
    <tr><td class="paramname">hi_limit</td><td>Higher deviation from expect_value acceptable to PASS the test </td></tr>
    <tr><td class="paramname">counter</td><td>Structure who content the result of test. Be used by final report </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to circular buffer, who contains the error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<p>Send command to SCPI engine</p>

</div>
</div>
<a id="a032a8eab3b1447960ec13ee39358c450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a032a8eab3b1447960ec13ee39358c450">&#9670;&nbsp;</a></span>test_cmd_substring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_cmd_substring </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>expected_substring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structTestResult.html">TestResult</a> *&#160;</td>
          <td class="paramname"><em>counter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCircularBuffer.html">CircularBuffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if the given command string contains the expected substring. </p>
<p>This function checks whether a given SCPI command string contains the specified expected substring and updates the test results accordingly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">title</td><td>Description or title of the test case. </td></tr>
    <tr><td class="paramname">cmd</td><td>The SCPI command string to be tested. </td></tr>
    <tr><td class="paramname">expected_substring</td><td>The substring that is expected to be found within the command string. </td></tr>
    <tr><td class="paramname">counter</td><td>A pointer to the test result structure to store the success or failure of the test. </td></tr>
    <tr><td class="paramname">buffer</td><td>A pointer to a circular buffer used for handling the input/output during testing.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the expected substring is found in the command string, false otherwise. </dd></dl>
<p>Send command to SCPI engine</p>

</div>
</div>
<a id="ad171446f146deeb8c2c79986e0f843c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad171446f146deeb8c2c79986e0f843c7">&#9670;&nbsp;</a></span>test_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_command </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>The function has been used to test the scpi command function. Mainly used to validate software functionalities. selftest board could be required to be present. </li>
</ul>
</p>
<p>Turn ON red led</p>
<p>Turn OFF red led</p>
<p>PAD REGISTER</p>
<p>PRINT FINAL REPORT AFTER TEST COMPLETION</p>

</div>
</div>
<a id="a7fd0a3e557c0c44cce4de05c0f581406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fd0a3e557c0c44cce4de05c0f581406">&#9670;&nbsp;</a></span>test_dac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool test_dac </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function used to set a value on the DAC device. </p>
<p>This function sets the specified voltage value on the MCP4725 DAC device. It is primarily for testing purposes and is not used during normal execution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The voltage value (in volts) to set on the DAC device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the value was successfully set on the DAC. </dd>
<dd>
false if an error occurred while setting the DAC value. </dd></dl>

</div>
</div>
<a id="a3c9d45ad6f08748305ee5abf775a9544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c9d45ad6f08748305ee5abf775a9544">&#9670;&nbsp;</a></span>test_eeprom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool test_eeprom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Function not used during normal execution The function has been used to validate the eeprom read write by byte and by page </li>
</ul>
</p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a2820d2a0e21922a80ee5edaa25d95367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2820d2a0e21922a80ee5edaa25d95367">&#9670;&nbsp;</a></span>test_i2c_ina219()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_i2c_ina219 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the software code below is not used by application but could be used, as example on how to work with I2C interface. This example was a proof of concept on I2C command available with a true device (INA219). </p>
<p>Mainly used to validate the reading of 16 bits register using I2C word </p>

</div>
</div>
<a id="a74346a55978a0cec00fea16b92e3cd35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74346a55978a0cec00fea16b92e3cd35">&#9670;&nbsp;</a></span>test_ina219()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_ina219 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Function not used during normal execution The function was used to test to get all the measure in same time from the INA219 </li>
</ul>
</p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a7c4492986b11310638a7730bf6658532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c4492986b11310638a7730bf6658532">&#9670;&nbsp;</a></span>test_inst_manual()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_inst_manual </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>The function perform the selftest of the instruments connected to the interconnect_IO board. The instruments are controlled manually using instruction on the master serial port </li>
</ul>
</p>
<p>Disable slaves Pico to reset configuration</p>
<p>Start slaves Pico after reset</p>
<p>Turn OFF red led</p>
<p>Close Power Relay et apply 5V to Selftest board</p>
<p>Wait to let time to relay to close and power the selftest board</p>
<p>Open Power Relay et remove 5V to Selftest board</p>
<p>Wait to let time to relay to close and power the selftest board</p>

</div>
</div>
<a id="a0acd1ee00e871f30689aab1a7246feb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0acd1ee00e871f30689aab1a7246feb0">&#9670;&nbsp;</a></span>test_ioboard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool test_ioboard </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Function not used during normal execution The function is used to validate the hardware after parts has been soldered and pico has firmware programmed </li>
</ul>
</p>
<p>Normally run step by step with debugger and hardware verified by visual check or by measuring voltage </p>

</div>
</div>
<a id="acb420da0ba7e8e1e84b61fec9b4de4b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb420da0ba7e8e1e84b61fec9b4de4b9">&#9670;&nbsp;</a></span>test_selftest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t test_selftest </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>testboard_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>run</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><ul>
<li>Run test sequence to validate hardware with selftest board </li>
</ul>
</p>
<p>This function perform the selftest to validate the hardware using only internal instruments. The test sequence follow the Validation_Test.xls Excel list</p>
<p>Detailed report is send to stdout port (usb) Summary report is send to serial port</p>
<dl class="section return"><dt>Returns</dt><dd>return value of 1 is selftest board is not detected </dd></dl>
<p>&lt; Variable used by TEST_SCPI_INPUT</p>
<p>&lt; array who will contains parts of SCPI command</p>
<p>Read 1-wire to detect if the selftest board is connected to interconnect IO</p>
<p>Disable slaves Pico to reset configuration</p>
<p>Start slaves Pico after reset</p>
<p>Turn OFF red led</p>
<p>Close Power Relay et apply 5V to Selftest board</p>
<p>Wait to let time to relay to close and power the selftest board</p>
<p>RELAY BANK TEST</p>
<p>Loop to test BK1-BK2 channel</p>
<p>Test the High side of relay</p>
<p>Test the LOW side of relay</p>
<p>Loop to test BK3-BK4 channel</p>
<p>Test the High side of relay</p>
<p>Test the LOW side of relay</p>
<p>PRINT FINAL REPORT AFTER TEST COMPLETION</p>

</div>
</div>
<a id="ae9ec3dc653dc7431f107092091e4dafc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ec3dc653dc7431f107092091e4dafc">&#9670;&nbsp;</a></span>test_spi_adx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_spi_adx </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the software code below is not used by application but could be used, as example on how to work with SPI interface. This example was a proof of concept on SPI command available with a true device (ADXL345). </p>
<p>The SPI command available on Pico SDK are basic and do not set the read bit, normally defined as bit 7 = 1 for read and bit 7 = 0 for write. The user will need to set the bit as showed on code below. </p>

</div>
</div>
<a id="af935e2bc2c8e175077947a8197df0234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af935e2bc2c8e175077947a8197df0234">&#9670;&nbsp;</a></span>wait_button_pressed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wait_button_pressed </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utility function to help debug of firmware Button is connected between pin 1 and 4 of CTRL INST connector on the back of interconnect IO. </p>
<p>function exit when button pressed </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af4c8396614d93905c2a91f60b9d2b4fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c8396614d93905c2a91f60b9d2b4fd">&#9670;&nbsp;</a></span>out_buffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char out_buffer[1024]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output buffer for storing data to be sent. </p>
<p>This buffer holds the data that will be sent via the output channel (e.g., serial or communication port). It has a fixed size of 1024 bytes. </p>

</div>
</div>
<a id="a668cec89f06b89ddf4d1ee33527eba18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668cec89f06b89ddf4d1ee33527eba18">&#9670;&nbsp;</a></span>out_buffer_pos</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t out_buffer_pos</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current position in the output buffer. </p>
<p>Tracks the position in the <code>out_buffer</code> where the next byte of data will be written. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d9edf6c004b4a7ff14fe9ae7a92214ee.html">firmware</a></li><li class="navelem"><a class="el" href="dir_c898ccd6027d5da3247aa855d21ca2cf.html">src</a></li><li class="navelem"><a class="el" href="test_8c.html">test.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
